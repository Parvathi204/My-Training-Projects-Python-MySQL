<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Banking System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">
    <h1 class="text-center mb-4">ðŸ’³ Banking System</h1>
    <div class="row">
      <div class="col-md-6">
        <button class="btn btn-primary w-100 mb-2" onclick="showForm('create')">Create Account</button>
        <button class="btn btn-success w-100 mb-2" onclick="showForm('deposit')">Deposit Money</button>
        <button class="btn btn-warning w-100 mb-2" onclick="showForm('withdraw')">Withdraw Money</button>
        <button class="btn btn-info w-100 mb-2" onclick="showForm('balance')">View Balance</button>
        <button class="btn btn-secondary w-100 mb-2" onclick="showForm('transactions')">Transaction History</button>
      </div>
      <div class="col-md-6">
        <div id="form-container"></div>
        <div id="result" class="mt-3"></div>
      </div>
    </div>
  </div>

<script>
function showForm(type) {
    let formHTML = '';
    if(type === 'create') {
        formHTML = `
            <h3>Create Account</h3>
            <input class="form-control mb-2" id="acc_no" placeholder="Account Number">
            <input class="form-control mb-2" id="name" placeholder="Name">
            <input class="form-control mb-2" id="balance" placeholder="Opening Balance">
            <button class="btn btn-primary" onclick="sendRequest('create')">Create</button>
        `;
    } else if(type === 'deposit') {
        formHTML = `
            <h3>Deposit Money</h3>
            <input class="form-control mb-2" id="acc_no" placeholder="Account Number">
            <input class="form-control mb-2" id="amount" placeholder="Amount">
            <button class="btn btn-success" onclick="sendRequest('deposit')">Deposit</button>
        `;
    } else if(type === 'withdraw') {
        formHTML = `
            <h3>Withdraw Money</h3>
            <input class="form-control mb-2" id="acc_no" placeholder="Account Number">
            <input class="form-control mb-2" id="amount" placeholder="Amount">
            <button class="btn btn-warning" onclick="sendRequest('withdraw')">Withdraw</button>
        `;
    } else if(type === 'balance') {
        formHTML = `
            <h3>View Balance</h3>
            <input class="form-control mb-2" id="acc_no" placeholder="Account Number">
            <button class="btn btn-info" onclick="sendRequest('balance')">Check Balance</button>
        `;
    } else if(type === 'transactions') {
        formHTML = `
            <h3>Transaction History</h3>
            <input class="form-control mb-2" id="acc_no" placeholder="Account Number">
            <button class="btn btn-secondary" onclick="sendRequest('transactions')">View Transactions</button>
        `;
    }
    document.getElementById('form-container').innerHTML = formHTML;
    document.getElementById('result').innerHTML = '';
}

function sendRequest(action) {
    let acc_no = document.getElementById('acc_no').value;
    let amount = document.getElementById('amount') ? document.getElementById('amount').value : null;
    let name = document.getElementById('name') ? document.getElementById('name').value : null;
    let balance = document.getElementById('balance') ? document.getElementById('balance').value : null;

    fetch(`/${action}`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({account_number: acc_no, amount: amount, name: name, balance: balance})
    })
    .then(response => response.json())
    .then(data => {
        if(data.status === 'success') {
            if(action === 'balance') {
                document.getElementById('result').innerHTML = `<div class="alert alert-success">ðŸ’° Balance: â‚¹${data.balance}</div>`;
            } else if(action === 'transactions') {
                let html = '<h5>Transactions:</h5><ul class="list-group">';
                data.transactions.forEach(t => {
                    html += `<li class="list-group-item">Type: ${t.type} | Amount: â‚¹${t.amount} | Date: ${t.date}</li>`;
                });
                html += '</ul>';
                document.getElementById('result').innerHTML = html;
            } else {
                document.getElementById('result').innerHTML = `<div class="alert alert-success">${data.message}</div>`;
            }
        } else {
            document.getElementById('result').innerHTML = `<div class="alert alert-danger">${data.message}</div>`;
        }
    });
}
</script>
</body>
</html>
